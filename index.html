
<!DOCTYPE html>
<html>
<head>

  <!-- angular js -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
  <!-- google charts -->
  <script type="text/javascript" src="https://www.google.com/jsapi?ext.js"></script>
  <!-- jquery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <!-- bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <!-- css -->
  <link rel="stylesheet" href="css/index.css">
  <!-- angular modules -->
  <script src="js/modules/app.js"></script>
  <script src="js/modules/controller.js"></script>
  <script src="js/modules/directives.js"></script>

  <title>SST-Pyr Fitting</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<body>
  <body>
    <div id="chart" ng-controller="ctrl">
      <h1 ng-hide="cellSelected">Select a cell to fit!</h1>
      <select ng-model="selectedCell" ng-options="cell for cell in cells" ng-change="changeCell()"></select>

      <div ng-show="cellSelected">
        <h2>Histogram</h2>
        <div id="chart-container">
          <histogram data="histogramData"
                    simdata="histogramSimData"
                    title="{{selectedCell}}"
                    zoomin="{{zoom}}"
                    viewmax="{{histHeight}}"
                    bins="{{binSize}}"
                    redraw="{{changed}}">
          </histogram>

        <div id="contacts">
          <h2>Simulation</h2>
          <table>
            <tr>
              <td class="no-border">
                <div class="panel panel-default contact add-padding">
                  <button type="button" ng-click="simulate()" class="btn btn-default full-width">Simulate</button>
                  <hr>
                  <button type="button" ng-click="resetSim()" class="btn btn-default full-width">Reset</button>
                  <hr>
                  <p>Num. Contacts: {{fitData.data[selectedCell].length}}<p>
                  <button class="btn btn-default full-width" data-toggle="modal" data-target="#addContactBox">
                      Add Contact
                  </button>
                </div>
              </td>
              <td ng-repeat="contact in fitData.data[selectedCell]" class="no-border">
                <div class="panel panel-default contact">
                  <div class="panel-heading">
                    Contact {{$index+1}}
                    <span class="close" ng-click="deleteContact($index)">&times;</span>
                  </div>
                  <div class="panel-body">
                    <form role="form">
                      <div class="form-group">
                        <label  class="col-sm-2 control-label"
                                  for="average">Average</label>
                        <div class="col-sm-10">
                            <input type="number" class="form-control"
                            id="average" ng-model="contact.q"/>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label"
                              for="stddev" >Standard Deviation</label>
                        <div class="col-sm-10">
                            <input type="number" class="form-control"
                                id="stddev" ng-model="contact.s"/>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label"
                              for="prob" >Probability</label>
                        <div class="col-sm-10">
                            <input type="number" class="form-control"
                                id="prob" ng-model="contact.p"/>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </td>
            </tr>
          </table>
        </div>

<!-- add contact box -->
<div class="modal fade" id="addContactBox" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close"
                   data-dismiss="modal">
                       <span aria-hidden="true">&times;</span>
                       <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    Add a Contact
                </h4>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">

                <form class="form-horizontal" role="form">
                  <div class="form-group">
                    <label  class="col-sm-2 control-label"
                              for="average">Average</label>
                    <div class="col-sm-10">
                        <input type="number" class="form-control" ng-model="modalQ"
                        id="average" placeholder="Average"/>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label"
                          for="stddev" >Standard Deviation</label>
                    <div class="col-sm-10">
                        <input type="number" class="form-control" ng-model="modalS"
                            id="stddev" placeholder="Standard Deviation"/>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-2 control-label"
                          for="prob" >Probability</label>
                    <div class="col-sm-10">
                        <input type="number" class="form-control" ng-model="modalP"
                            id="prob" placeholder="Probability"/>
                    </div>
                  </div>
                </form>

            </div>

            <!-- Modal Footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">
                  Cancel
                </button>
                <button type="submit" class="btn btn-primary" ng-click="addContact()"
                  data-dismiss="modal">
                  Add
                </button>
            </div>
        </div>
    </div>
</div>

        <div style="clear: both"></div>

        <table style="width: 100%">
          <tr class="no-border">
            <td class="no-border settings">
              <div>
                <h2>Settings</h2>
                <table class="styled-table">
                  <tr>
                    <td class="row-header">Zoom</td>
                    <td style="text-align: left">
                      <input type="radio" name="zoom" ng-model="zoom" value="auto">Auto<br>
                      <input type="radio" name="zoom" ng-model="zoom" value="set">Set to</input>
                      <input type="number" ng-model="histHeight">
                    </td>
                  </tr>
                  <tr>
                    <td class="row-header">Bin Size</td>
                    <td><input type="number" ng-model="binSize" step="0.01" min="0.01" max="1"></td>
                  </tr>
                  <tr>
                    <td class="row-header">Trial Selection</td>
                    <td style="text-align: left">
                      <input type="radio" ng-model="trial.choice" value="range" ng-change="changeData()"> Range<br>
                      <input type="radio" ng-model="trial.choice" value="individual" ng-change="changeData()"> Individual
                    </td>
                  </tr>
                  <tr>
                    <td class="row-header">Trials</td>
                    <td><input type="range" ng-model="trial.number" min="1" max="10" ng-change="changeData()">
                        <input type="text" ng-model="trial.number" ng-change="changeData()">
                    </td>
                  </tr>
                  <tr>
                    <td class="row-header">Show data</td>
                    <td><input type="checkbox" ng-model="showTable"></td>
                  </tr>
                </table>
              </div>
              <div style="clear: both"></div>
            </div>
          </td>

          <td class="no-border statistics">
            <div>
              <h2>Statistics</h2>
              <table class="styled-table">
                <th></th>
                <th>Cell Data</th>
                <th>Simulation</th>
                <tr ng-repeat="(stat,value) in stats" class="row-header">
                  <td>{{stat}}</td>
                  <td>{{value['cell']}}</td>
                  <td>{{value['sim']}}</td>
                </tr>
              </table>
            </div>
          </td>
        </tr>
      </table>


        <div id="table" ng-show="showTable">
          <h2>Data Table</h2>
          <table>
            <th>Stimulus No.</th>
            <th ng-repeat="(trial,value) in cellData[selectedCell][1]">
              {{trial}}
            </th>
            <tr ng-repeat="(col,entries) in cellData[selectedCell]">
              <td class="row-header">{{col}}</td>
              <td ng-repeat="(trial,value) in entries">{{value}}</td>
            </tr>
          </table>
        </div>


      </div>
    </div>
  </body>
</body>

</html>
